<html>
  <head>
    <script type="text/javascript">
      UTF8 = {
	      encode: function(s){
		      for(var c, i = -1, l = (s = s.split("")).length, o = String.fromCharCode; ++i < l;
			      s[i] = (c = s[i].charCodeAt(0)) >= 127 ? o(0xc0 | (c >>> 6)) + o(0x80 | (c & 0x3f)) : s[i]
		      );
		      return s.join("");
	      },
	      decode: function(s){
		      for(var a, b, i = -1, l = (s = s.split("")).length, o = String.fromCharCode, c = "charCodeAt"; ++i < l;
			      ((a = s[i][c](0)) & 0x80) &&
			      (s[i] = (a & 0xfc) == 0xc0 && ((b = s[i + 1][c](0)) & 0xc0) == 0x80 ?
			      o(((a & 0x03) << 6) + (b & 0x3f)) : o(128), s[++i] = "")
		      );
		      return s.join("");
	      }
      };
      
      function getHTML() {
        var fullHTML = document.getElementById("markdown").value;
        return fullHTML;
      }
      
      function preview () {
        window.open("data:text/html;charset=utf-8,"+UTF8.encode(getHTML()),'_blank');
      }
      function download () {
        window.location = "data:text/html;charset=utf-8;filename=tada.txt,"+UTF8.encode(getHTML());
      }
      
    </script>
  </head>
  <body>
    <textarea id="markdown"></textarea>
    <br />
    <a href="#" onclick="preview()">PREVIEW</a>
    <a href="data:text/txt;charset=utf-8;headers=Content-Disposition%3A%20attachment%3B%20filename%3D%22with%20spaces.txt%22%0D%0AContent-Language%3A%20en;base64,4oiaDQo%3D">OFFLINE DOWNLOAD</a>
    <a href="#" onclick="alert('error preparing download')">ONLINE DOWNLOAD</a>
  </body>
</html>

<!--
data:text/plain;charset=utf-8;filename=tada.txt;content-disposition=attachment,file_data
-->
